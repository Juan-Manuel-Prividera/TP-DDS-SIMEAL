{{> templates/navbar}}

<h1 class="mt-2">Seleccionar o Crear Formulario</h1>
<div class="container-formularios">
    <div class="left">
    <!-- Listado de Formularios Existentes -->
    <div class="lista-formularios">
        <h2>Formularios existentes</h2>
        <ul>
            {{#each formularios}}
                <li>
                    <a href="/formulario/{{this.id}}">{{this.nombre}}</a>
                    <span> - Fecha Creación: {{this.fechaCreacion}}</span>
                    <button class="btn btn-danger ml-auto btn-sm" onclick="borrarFormulario({{this.id}})">Eliminar</button>
                </li>
            {{/each}}
        </ul>
    </div>
    </div>
    <!-- Crear un nuevo formulario -->
    <div class="crear-nuevo-formulario">
        <h2>Crear nuevo formulario</h2>
        <form id="formCrearFormulario" method="POST" action="/formulario">
            <div class="form-group">
                <label for="nombreFormulario">Nombre del Formulario</label>
                <input type="text" name="nombreFormulario" id="nombreFormulario" class="form-control" placeholder="Nombre del formulario" required>
            </div>
            <div class="form-group">
                <label for="rol">Para que tipo de usuario es</label>
                <select name="rol" id="rol" class="form-control ml-1" required>
                    <option value="">Selecciona Rol de destino</option>
                    <option value="JURIDICO">Humano</option>
                    <option value="HUMANO">Juridico</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary mt-3">Crear Formulario</button>
        </form>
    </div>
</div>
<script>
    function borrarFormulario(formulario_id) {
        // Confirmación antes de eliminar
        if (confirm("¿Estás seguro de que deseas eliminar este formulario?")) {
            // Enviar una solicitud POST al servidor para eliminar la pregunta
            fetch(`/formulario/${formulario_id}`, {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json',
                },
            })
                    .then(response => {
                        if (response.ok) {
                            // Recargar la página o eliminar la pregunta del DOM si se eliminó con éxito
                            //location.reload(); // Recargar la página para reflejar los cambios
                            window.location.reload(true);
                        } else {
                            alert('Error al eliminar el formulario');
                        }
                    })
                    .catch(error => {
                        console.error('Error al eliminar el formulario:', error);
                        alert('Hubo un problema al intentar eliminar el formulario.');
                    });
        }
    }
</script>